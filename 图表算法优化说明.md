# 混凝土强度可视化分析图表算法优化说明

## 优化概述

根据提供的图片中"影响混凝土强度的因素"权重排序表,对 `Step4.vue` 中的图表算法进行了全面优化,使评分和建议更贴合实际工程经验。

## 图片中的7个关键因素及权重

| 排序 | 因子                  | 平均权重区间 | 一句话解释                                    |
| ---- | --------------------- | ------------ | --------------------------------------------- |
| 1    | 水泥用量(C)           | 0.40-0.45    | "胶凝老大"——每多10 kg/m³,强度通常涨1-1.5 MPa  |
| 2    | 水灰比(w/c)           | 0.25-0.30    | 强度"生命线"; w/c降0.1,强度约升5-7 MPa        |
| 3    | 高效减水剂掺量        | 0.10-0.12    | 保住低w/c又可施工,间接抬高强度                |
| 4    | 养护温度×龄期(成熟度) | 0.08-0.10    | 温度每低5°C,相同龄期强度低5%左右              |
| 5    | 粉煤灰/矿渣掺量       | 0.05-0.07    | 早期稀释效应,后期微粉填充+二次水化,权重"中游" |
| 6    | 粗骨料用量            | 0.03-0.05    | 提供骨架,但自身强度远高于界面,权重相对小      |
| 7    | 细骨料用量&砂率       | 0.02-0.04    | 主要影响工作性,对强度边际贡献最小             |

## 主要优化内容

### 1. 评分函数优化 (基于权重区间)

#### 1.1 水灰比评分 `getMixRatioScore` (权重25-30%)

-   **优化前**: 简单的区间评分,未体现"生命线"特性
-   **优化后**:
    -   ≤0.30: 98分 (极优控制)
    -   ≤0.35: 95分 (优秀)
    -   ≤0.40: 88分 (良好)
    -   ≤0.45: 75分 (中等)
    -   ≤0.50: 60分 (偏高)
    -   ≤0.55: 45分 (过高)
    -   > 0.55: 30分 (严重影响)
-   **依据**: 水灰比是第2影响因素,每降0.1强度提升5-7MPa

#### 1.2 水泥质量评分 `getCementScore` (权重40-45%)

-   **优化前**: 仅区分几种水泥类型
-   **优化后**: 细化评分体系
    -   52.5R: 98分 (早强高强)
    -   52.5: 95分 (高强水泥)
    -   42.5R: 90分 (早强普通)
    -   42.5: 85分 (标准普通)
    -   32.5R: 75分
    -   32.5: 70分
-   **依据**: 水泥是"胶凝老大",权重最高(40-45%)

#### 1.3 骨料质量评分 `getAggregateScore` (权重3-5%)

-   **优化前**: 简单判断含泥量
-   **优化后**: 综合考虑含泥量、级配、针片状含量
    -   含泥量≤0.3%: +15分 (优秀)
    -   含泥量≤0.5%: +10分 (良好)
    -   含泥量≤0.7%: +5分 (中等)
    -   含泥量≤1.0%: 0分 (合格线)
    -   含泥量>1.0%: -10分 (超标)
    -   连续级配: +5分
    -   针片状<5%: +5分
-   **依据**: 骨料权重仅3-5%,提供骨架但对强度影响相对较小

#### 1.4 外加剂评分 `getAdmixtureScore` (权重10-12%)

-   **优化前**: 仅区分是否为高效减水剂
-   **优化后**:
    -   聚羧酸+高效: +25分 (最优)
    -   高效减水剂: +20分
    -   聚羧酸: +18分
    -   普通减水剂: +12分
    -   掺量1.5-2.5%: +5分 (最优掺量)
    -   掺量>2.5%: -3分 (过量)
-   **依据**: 减水剂可保住低w/c又可施工,间接抬高强度

#### 1.5 养护条件评分 `getCuringScore` (权重8-10%)

-   **优化前**: 简单分类养护方式
-   **优化后**:
    -   标准养护(20±2°C,≥95%湿度): +25分
    -   蒸汽养护: +20分
    -   保温养护: +15分
    -   覆盖/洒水: +10分
    -   自然养护: +5分
    -   低温(<15°C): -10分
    -   高温(>30°C): -5分
-   **依据**: 温度每低5°C,相同龄期强度低5%左右

### 2. 评价函数优化

#### 2.1 水灰比等级评价 `getWaterCementRatioLevel`

-   新增7个等级细分,每个等级都有清晰的工程意义
-   示例: "优秀(高强混凝土水平)", "中等(标准范围)"

#### 2.2 水灰比建议 `getWaterCementRatioAdvice`

-   针对不同水灰比区间给出详细的优化建议
-   包含具体数值建议和预期效果
-   示例: "建议通过添加聚羧酸高效减水剂(掺量1.5-2.0%)来降低至0.40以下,预计强度可提升10-15%"

#### 2.3 骨料质量评价 `getAggregateComment`

-   基于含泥量精确评价骨料质量
-   包含对强度影响的量化说明
-   示例: "骨料质量一般(含泥量超标,会降低强度3-5%)"

#### 2.4 养护质量评价 `getCuringQualityComment`

-   结合达标率和养护条件综合评价
-   特别说明温度影响: "温度每降5°C强度约降5%"

#### 2.5 养护建议 `getCuringAdvice`

-   针对不同养护方式给出详细指导
-   包含具体操作要求和注意事项
-   示例:
    -   标准养护: 说明最优条件和成熟度理论
    -   低温养护: 提供保温措施和延长养护期建议
    -   高温养护: 强调洒水频次和防止湿度不足

### 3. 综合评价优化

#### 3.1 加权平均评分 `getOverallMixComment`

-   **优化前**: 简单算术平均
-   **优化后**: 按实际权重加权平均
    ```
    综合评分 = 水泥质量 × 40% + 水灰比 × 30% + 减水剂 × 12% + 养护 × 13% + 骨料 × 5%
    ```
-   评价中明确说明各因素权重和影响
-   示例: "水泥用量充足且质量优良(权重40%),水灰比控制优秀(权重30%)"

#### 3.2 优化建议 `getOptimizationAdvice`

-   **优化前**: 简单列举需要改进的地方
-   **优化后**:
    -   按权重优先级排序建议 (高权重因素优先)
    -   标注优先级: 【高优先级】、【中优先级】
    -   量化改进效果: "每降0.05可提升强度3-4MPa"
    -   分三级总结:
        -   ⚠️ 发现关键问题,必须立即调整
        -   💡 存在优化空间,建议改进
        -   ✓ 细节优化建议

### 4. 最终结论优化 `getFinalConclusion`

#### 新增7个因素权重排序分析

按照图片中的排序逐一分析:

```
📊 关键影响因素分析（按权重排序）：
【排序1】水泥用量(权重40-45%)："胶凝老大"，P.O 42.5，水泥质量是决定强度的首要因素。
【排序2】水灰比(权重25-30%)：0.45，中等，强度"生命线"，每降0.1强度提升5-7MPa。
【排序3】减水剂掺量(权重10-12%)：聚羧酸高效减水剂，高效减水剂可保住低w/c又可施工。
【排序4】养护成熟度(权重8-10%)：标准养护20±2°C，温度每低5°C强度约降5%。
【排序5】粉煤灰/矿渣(权重5-7%)：早期稀释效应，后期微粉填充+二次水化，权重较小。
【排序6】粗骨料用量(权重3-5%)：碎石5-25mm连续级配，提供骨架但权重相对小。
【排序7】细骨料&砂率(权重2-4%)：主要影响工作性，对强度边际贡献最小。

🎯 综合评分：87.3分（按权重加权平均）
```

## 优化效果

### 1. 更科学的评分体系

-   评分完全基于工程实践中的权重分布
-   高权重因素(水泥、水灰比)的评分更严格
-   低权重因素(骨料、砂率)的评分更宽松

### 2. 更实用的优化建议

-   优先优化高权重因素,投入产出比更高
-   建议具体可操作,包含数值目标
-   量化改进效果,便于决策

### 3. 更全面的影响因素分析

-   完整展示7个因素及其权重
-   每个因素都有"一句话解释"
-   用户可以清楚了解哪些因素最关键

### 4. 更专业的术语和表达

-   使用工程界通用的术语: "胶凝老大"、"生命线"、"成熟度"
-   数据量化表达: "每降0.1强度提升5-7MPa"
-   符合规范要求的建议

## 技术实现

### 1. 评分函数

所有评分函数返回0-100分,基准分根据权重设定:

-   高权重因素(水泥、水灰比): 基准分低,评分严格
-   低权重因素(骨料、砂率): 基准分高,评分宽松

### 2. 加权计算

```typescript
const weightedScore =
    cementScore * 0.4 + // 水泥质量 40%
    waterCementScore * 0.3 + // 水灰比 30%
    admixtureScore * 0.12 + // 减水剂 12%
    curingScore * 0.13 + // 养护 13%
    aggregateScore * 0.05; // 骨料 5%
```

### 3. 优先级判定

```typescript
let priorityLevel = 0; // 0=无需优化, 1=建议优化, 2=必须优化

// 高权重因素问题 → priorityLevel = 2
if (data.water_cement_ratio > 0.5) {
    priorityLevel = 2;
}

// 中等权重因素问题 → priorityLevel = 1
if (!data.admixture.includes('高效')) {
    priorityLevel = 1;
}
```

## 使用建议

1. **关注综合评分**: 90分以上为优秀,80-90为良好,70-80为合格
2. **优先优化高优先级项目**: 标注为【高优先级】的建议对强度影响最大
3. **参考权重排序**: 优化配合比时重点关注排序前3的因素(占总权重70%以上)
4. **量化改进目标**: 建议中包含的数值可作为配合比调整的参考目标

## 文件位置

-   优化文件: `/Users/sunyu/product/zgzp/cement/src/views/componets/components/Step4.vue`
-   修改行数: 约600-1100行
-   主要修改函数:
    -   `getMixRatioScore` - 水灰比评分
    -   `getCementScore` - 水泥质量评分
    -   `getAggregateScore` - 骨料质量评分
    -   `getAdmixtureScore` - 外加剂评分
    -   `getCuringScore` - 养护条件评分
    -   `getOverallMixComment` - 综合评价
    -   `getOptimizationAdvice` - 优化建议
    -   `getFinalConclusion` - 最终结论

## 参考依据

-   图片: "影响混凝土强度的因素"权重排序表
-   工程规范: GB/T 50081-2019, GB/T 50107-2010
-   理论依据: 鲍罗米公式、成熟度理论
-   工程经验: 实测数据分析和专家经验总结

---

**优化时间**: 2025年10月24日
**优化目标**: 使图表分析更贴合实际工程中各因素对混凝土强度的影响权重
